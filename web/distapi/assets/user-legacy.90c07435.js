!function(){function e(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(l){return void r(l)}u.done?t(s):Promise.resolve(s).then(n,a)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(a,i){var o=t.apply(r,n);function u(t){e(o,a,i,u,s,"next",t)}function s(t){e(o,a,i,u,s,"throw",t)}u(void 0)}))}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=document.createElement("style");i.innerHTML=".user-dialog .header-img-box{width:200px;height:200px;border:1px dashed #ccc;border-radius:20px;text-align:center;line-height:200px;cursor:pointer}.user-dialog .avatar-uploader .el-upload:hover{border-color:#409eff}.user-dialog .avatar-uploader-icon{border:1px dashed #d9d9d9!important;border-radius:6px;font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.user-dialog .avatar{width:178px;height:178px;display:block}\n",document.head.appendChild(i),System.register(["./index-legacy.2b2c1438.js","./authority-legacy.30081820.js","./infoList-legacy.22629927.js","./vendor-legacy.89c3086c.js","./index-legacy.79ad54f2.js","./index-legacy.4b0c4fdd.js","./warningBar-legacy.8bc98fe0.js","./dictionary-legacy.f4c16c6a.js","./date-legacy.431857fb.js","./fileUploadAndDownload-legacy.ce8887c1.js"],(function(e){"use strict";var r,a,i,o,u,s,l,c,d,f,p,h,g,m,y,b,v,I;return{setters:[function(e){r=e._,a=e.t,i=e.v,o=e.w,u=e.x},function(e){s=e.g},function(e){l=e.i},function(e){c=e.G,d=e.r,f=e.o,p=e.f,h=e.g,g=e.k,m=e.w,y=e.s},function(e){b=e.C},function(e){v=e.C},function(e){I=e.w},function(){},function(){},function(){}],execute:function(){var w={name:"Api",components:{CustomPic:b,ChooseImg:v,warningBar:I},mixins:[l],data:function(){return{listApi:a,path:"/api",authOptions:[],addUserDialog:!1,userInfo:{username:"",password:"",nickName:"",headerImg:"",authorityId:"",authorityIds:[]},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"最低5位字符",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{min:6,message:"最低6位字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],authorityId:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},computed:n({},c("user",["token"])),watch:{tableData:function(){this.setAuthorityIds()}},created:function(){var e=this;return t(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTableData();case 2:return t.next=4,s({page:1,pageSize:999});case 4:r=t.sent,e.setOptions(r.data.list);case 6:case"end":return t.stop()}}),t)})))()},methods:{setAuthorityIds:function(){this.tableData&&this.tableData.forEach((function(e){var t=e.authorities&&e.authorities.forEach((function(e){return e.authorityId}));e.authorityIds=t}))},openHeaderChange:function(){this.$refs.chooseImg.open()},setOptions:function(e){this.authOptions=[],this.setAuthorityOptions(e,this.authOptions)},setAuthorityOptions:function(e,t){var r=this;e&&e.forEach((function(e){if(e.children&&e.children.length){var n={authorityId:e.authorityId,authorityName:e.authorityName,children:[]};r.setAuthorityOptions(e.children,n.children),t.push(n)}else{var a={authorityId:e.authorityId,authorityName:e.authorityName};t.push(a)}}))},deleteUser:function(e){var r=this;return t(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({id:e.ID});case 2:if(0!==t.sent.code){t.next=8;break}return r.$message.success("删除成功"),t.next=7,r.getTableData();case 7:e.visible=!1;case 8:case"end":return t.stop()}}),t)})))()},enterAddUserDialog:function(){var e=this;return t(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.userInfo.authorityId=e.userInfo.authorityIds[0],e.$refs.userForm.validate(function(){var r=t(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=8;break}return t.next=3,o(e.userInfo);case 3:return 0===t.sent.code&&e.$message({type:"success",message:"创建成功"}),t.next=7,e.getTableData();case 7:e.closeAddUserDialog();case 8:case"end":return t.stop()}}),t)})));return function(e){return r.apply(this,arguments)}}());case 2:case"end":return r.stop()}}),r)})))()},closeAddUserDialog:function(){this.$refs.userForm.resetFields(),this.userInfo.headerImg="",this.userInfo.authorityIds=[],this.addUserDialog=!1},addUser:function(){this.addUserDialog=!0},changeAuthority:function(e,r){var n=this;return t(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r){a.next=2;break}return a.abrupt("return");case 2:n.$nextTick(t(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u({ID:e.ID,authorityIds:e.authorityIds});case 2:0===t.sent.code&&n.$message({type:"success",message:"角色设置成功"});case 4:case"end":return t.stop()}}),t)}))));case 3:case"end":return a.stop()}}),a)})))()}}},x={class:"gva-table-box"},k={class:"gva-btn-list"},C=y("新增用户"),O=g("p",null,"确定要删除此用户吗",-1),D={style:{"text-align":"right","margin-top":"8px"}},U=y("取消"),j=y("确定"),V=y("删除"),_={class:"gva-pagination"},z=["src"],A={key:1,class:"header-img-box"},P={class:"dialog-footer"},R=y("取 消"),N=y("确 定");e("default",r(w,[["render",function(e,t,r,n,a,i){var o=d("warning-bar"),u=d("el-button"),s=d("CustomPic"),l=d("el-table-column"),c=d("el-cascader"),y=d("el-popover"),b=d("el-table"),v=d("el-pagination"),I=d("el-input"),w=d("el-form-item"),S=d("el-form"),T=d("el-dialog"),$=d("ChooseImg");return f(),p("div",null,[h(o,{title:"注：右上角头像下拉可切换角色"}),g("div",x,[g("div",k,[h(u,{size:"mini",type:"primary",icon:"el-icon-plus",onClick:i.addUser},{default:m((function(){return[C]})),_:1},8,["onClick"])]),h(b,{data:e.tableData},{default:m((function(){return[h(l,{align:"left",label:"头像","min-width":"50"},{default:m((function(e){return[h(s,{style:{"margin-top":"8px"},"pic-src":e.row.headerImg},null,8,["pic-src"])]})),_:1}),h(l,{align:"left",label:"UUID","min-width":"250",prop:"uuid"}),h(l,{align:"left",label:"用户名","min-width":"150",prop:"userName"}),h(l,{align:"left",label:"昵称","min-width":"150",prop:"nickName"}),h(l,{align:"left",label:"用户角色","min-width":"150"},{default:m((function(e){return[h(c,{modelValue:e.row.authorityIds,"onUpdate:modelValue":function(t){return e.row.authorityIds=t},options:a.authOptions,"show-all-levels":!1,"collapse-tags":"",props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1,onVisibleChange:function(t){i.changeAuthority(e.row,t)},onRemoveTag:function(){i.changeAuthority(e.row,!1)}},null,8,["modelValue","onUpdate:modelValue","options","onVisibleChange","onRemoveTag"])]})),_:1}),h(l,{align:"left",label:"操作","min-width":"150"},{default:m((function(e){return[h(y,{visible:e.row.visible,placement:"top",width:"160"},{reference:m((function(){return[h(u,{type:"text",icon:"el-icon-delete",size:"mini"},{default:m((function(){return[V]})),_:1})]})),default:m((function(){return[O,g("div",D,[h(u,{size:"mini",type:"text",onClick:function(t){return e.row.visible=!1}},{default:m((function(){return[U]})),_:2},1032,["onClick"]),h(u,{type:"primary",size:"mini",onClick:function(t){return i.deleteUser(e.row)}},{default:m((function(){return[j]})),_:2},1032,["onClick"])])]})),_:2},1032,["visible"])]})),_:1})]})),_:1},8,["data"]),g("div",_,[h(v,{"current-page":e.page,"page-size":e.pageSize,"page-sizes":[10,30,50,100],total:e.total,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:e.handleCurrentChange,onSizeChange:e.handleSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]),h(T,{modelValue:a.addUserDialog,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.addUserDialog=e}),"custom-class":"user-dialog",title:"新增用户"},{footer:m((function(){return[g("div",P,[h(u,{size:"small",onClick:i.closeAddUserDialog},{default:m((function(){return[R]})),_:1},8,["onClick"]),h(u,{size:"small",type:"primary",onClick:i.enterAddUserDialog},{default:m((function(){return[N]})),_:1},8,["onClick"])])]})),default:m((function(){return[h(S,{ref:"userForm",rules:a.rules,model:a.userInfo,"label-width":"80px"},{default:m((function(){return[h(w,{label:"用户名",prop:"username"},{default:m((function(){return[h(I,{modelValue:a.userInfo.username,"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.userInfo.username=e})},null,8,["modelValue"])]})),_:1}),h(w,{label:"密码",prop:"password"},{default:m((function(){return[h(I,{modelValue:a.userInfo.password,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.userInfo.password=e})},null,8,["modelValue"])]})),_:1}),h(w,{label:"别名",prop:"nickName"},{default:m((function(){return[h(I,{modelValue:a.userInfo.nickName,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.userInfo.nickName=e})},null,8,["modelValue"])]})),_:1}),h(w,{label:"用户角色",prop:"authorityId"},{default:m((function(){return[h(c,{modelValue:a.userInfo.authorityIds,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.userInfo.authorityIds=e}),style:{width:"100%"},options:a.authOptions,"show-all-levels":!1,props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1},null,8,["modelValue","options"])]})),_:1}),h(w,{label:"头像","label-width":"80px"},{default:m((function(){return[g("div",{style:{display:"inline-block"},onClick:t[4]||(t[4]=function(){return i.openHeaderChange&&i.openHeaderChange.apply(i,arguments)})},[a.userInfo.headerImg?(f(),p("img",{key:0,class:"header-img-box",src:a.userInfo.headerImg&&"http"!==a.userInfo.headerImg.slice(0,4)?a.path+a.userInfo.headerImg:a.userInfo.headerImg},null,8,z)):(f(),p("div",A,"从媒体库选择"))])]})),_:1})]})),_:1},8,["rules","model"])]})),_:1},8,["modelValue"]),h($,{ref:"chooseImg",target:a.userInfo,"target-key":"headerImg"},null,8,["target"])])}]]))}}}))}();
