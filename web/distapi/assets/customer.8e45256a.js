var e=(e,t,a)=>new Promise(((l,o)=>{var i=e=>{try{r(a.next(e))}catch(t){o(t)}},s=e=>{try{r(a.throw(e))}catch(t){o(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,s);r((a=a.apply(e,t)).next())}));import{s as t,_ as a}from"./index.bf0eadd2.js";import{i as l}from"./infoList.89930291.js";import{w as o}from"./warningBar.f4c6efa3.js";import{r as i,o as s,f as r,g as n,k as m,w as d,u,s as c}from"./vendor.ab24dc3f.js";import"./dictionary.03156ab7.js";import"./date.23f5a973.js";const p=e=>t({url:"/customer/customer",method:"post",data:e}),f=e=>t({url:"/customer/customerList",method:"get",params:e}),g={name:"Customer",components:{warningBar:o},mixins:[l],data:()=>({listApi:f,dialogFormVisible:!1,type:"",form:{customerName:"",customerPhoneData:""}}),created(){this.getTableData()},methods:{updateCustomer(a){return e(this,null,(function*(){const e=yield(l={ID:a.ID},t({url:"/customer/customer",method:"get",params:l}));var l;this.type="update",0===e.code&&(this.form=e.data.customer,this.dialogFormVisible=!0)}))},closeDialog(){this.dialogFormVisible=!1,this.form={customerName:"",customerPhoneData:""}},deleteCustomer(a){return e(this,null,(function*(){a.visible=!1;var e;0===(yield(e={ID:a.ID},t({url:"/customer/customer",method:"delete",data:e}))).code&&(this.$message({type:"success",message:"删除成功"}),1===this.tableData.length&&this.page>1&&this.page--,this.getTableData())}))},enterDialog(){return e(this,null,(function*(){let e;switch(this.type){case"create":e=yield p(this.form);break;case"update":e=yield(a=this.form,t({url:"/customer/customer",method:"put",data:a}));break;default:e=yield p(this.form)}var a;0===e.code&&(this.closeDialog(),this.getTableData())}))},openDialog(){this.type="create",this.dialogFormVisible=!0}}},h={class:"gva-table-box"},b={class:"gva-btn-list"},y=c("新增"),C=c("变更"),v=m("p",null,"确定要删除吗？",-1),D={style:{"text-align":"right","margin-top":"8px"}},w=c("取消"),k=c("确定"),_=c("删除"),z={class:"gva-pagination"},V={class:"dialog-footer"},x=c("取 消"),j=c("确 定");var I=a(g,[["render",function(e,t,a,l,o,c){const p=i("warning-bar"),f=i("el-button"),g=i("el-table-column"),I=i("el-popover"),P=i("el-table"),F=i("el-pagination"),N=i("el-input"),S=i("el-form-item"),T=i("el-form"),U=i("el-dialog");return s(),r("div",null,[n(p,{title:"在资源权限中将此角色的资源权限清空 或者不包含创建者的角色 即可屏蔽此客户资源的显示"}),m("div",h,[m("div",b,[n(f,{size:"mini",type:"primary",icon:"el-icon-plus",onClick:c.openDialog},{default:d((()=>[y])),_:1},8,["onClick"])]),n(P,{ref:"multipleTable",data:e.tableData,style:{width:"100%"},"tooltip-effect":"dark","row-key":"ID"},{default:d((()=>[n(g,{type:"selection",width:"55"}),n(g,{align:"left",label:"接入日期",width:"180"},{default:d((t=>[m("span",null,u(e.formatDate(t.row.CreatedAt)),1)])),_:1}),n(g,{align:"left",label:"姓名",prop:"customerName",width:"120"}),n(g,{align:"left",label:"电话",prop:"customerPhoneData",width:"120"}),n(g,{align:"left",label:"接入人ID",prop:"sysUserId",width:"120"}),n(g,{align:"left",label:"按钮组","min-width":"160"},{default:d((e=>[n(f,{size:"small",type:"text",icon:"el-icon-edit",onClick:t=>c.updateCustomer(e.row)},{default:d((()=>[C])),_:2},1032,["onClick"]),n(I,{visible:e.row.visible,placement:"top",width:"160"},{reference:d((()=>[n(f,{type:"text",icon:"el-icon-delete",size:"mini"},{default:d((()=>[_])),_:1})])),default:d((()=>[v,m("div",D,[n(f,{size:"mini",type:"text",onClick:t=>e.row.visible=!1},{default:d((()=>[w])),_:2},1032,["onClick"]),n(f,{type:"primary",size:"mini",onClick:t=>c.deleteCustomer(e.row)},{default:d((()=>[k])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])),_:1})])),_:1},8,["data"]),m("div",z,[n(F,{"current-page":e.page,"page-size":e.pageSize,"page-sizes":[10,30,50,100],total:e.total,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:e.handleCurrentChange,onSizeChange:e.handleSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]),n(U,{modelValue:o.dialogFormVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialogFormVisible=e),"before-close":c.closeDialog,title:"客户"},{footer:d((()=>[m("div",V,[n(f,{size:"small",onClick:c.closeDialog},{default:d((()=>[x])),_:1},8,["onClick"]),n(f,{size:"small",type:"primary",onClick:c.enterDialog},{default:d((()=>[j])),_:1},8,["onClick"])])])),default:d((()=>[n(T,{inline:!0,model:o.form,"label-width":"80px"},{default:d((()=>[n(S,{label:"客户名"},{default:d((()=>[n(N,{modelValue:o.form.customerName,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.customerName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),n(S,{label:"客户电话"},{default:d((()=>[n(N,{modelValue:o.form.customerPhoneData,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.customerPhoneData=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"])])}]]);export{I as default};
