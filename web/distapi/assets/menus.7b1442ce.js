var e=(e,t,a)=>new Promise(((s,n)=>{var r=e=>{try{u(a.next(e))}catch(t){n(t)}},o=e=>{try{u(a.throw(e))}catch(t){n(t)}},u=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,o);u((a=a.apply(e,t)).next())}));import{_ as t,h as a,i as s,j as n}from"./index.bf0eadd2.js";import{u as r}from"./authority.c22e40dc.js";import{r as o,o as u,f as d,k as i,g as l,w as c,u as h,B as m,s as f}from"./vendor.ab24dc3f.js";const p={name:"Menus",props:{row:{default:function(){return{}},type:Object}},data:()=>({menuTreeData:[],menuTreeIds:[],needConfirm:!1,menuDefaultProps:{children:"children",label:function(e){return e.meta.title}}}),created(){return e(this,null,(function*(){const e=yield a();this.menuTreeData=e.data.menus;const t=(yield s({authorityId:this.row.authorityId})).data.menus,n=[];t.forEach((e=>{t.some((t=>t.parentId===e.menuId))||n.push(Number(e.menuId))})),this.menuTreeIds=n}))},methods:{setDefault(t){return e(this,null,(function*(){const e=yield r({authorityId:this.row.authorityId,AuthorityName:this.row.authorityName,parentId:this.row.parentId,defaultRouter:t.name});0===e.code&&(this.$message({type:"success",message:"设置成功"}),this.$emit("changeRow","defaultRouter",e.data.authority.defaultRouter))}))},nodeChange(){this.needConfirm=!0},enterAndNext(){this.relation()},relation(){return e(this,null,(function*(){const e=this.$refs.menuTree.getCheckedNodes(!1,!0);0===(yield n({menus:e,authorityId:this.row.authorityId})).code&&this.$message({type:"success",message:"菜单设置成功!"})}))}}},y={class:"clearflex"},k=f("确 定"),I={class:"custom-tree-node"};var w=t(p,[["render",function(e,t,a,s,n,r){const p=o("el-button"),w=o("el-tree");return u(),d("div",null,[i("div",y,[l(p,{class:"fl-right",size:"mini",type:"primary",onClick:r.relation},{default:c((()=>[k])),_:1},8,["onClick"])]),l(w,{ref:"menuTree",data:n.menuTreeData,"default-checked-keys":n.menuTreeIds,props:n.menuDefaultProps,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"",onCheck:r.nodeChange},{default:c((({node:e,data:t})=>[i("span",I,[i("span",null,h(e.label),1),i("span",null,[l(p,{type:"text",size:"mini",style:m({color:a.row.defaultRouter===t.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>r.setDefault(t)},{default:c((()=>[f(h(a.row.defaultRouter===t.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])])])])),_:1},8,["data","default-checked-keys","props","onCheck"])])}]]);export{w as default};
