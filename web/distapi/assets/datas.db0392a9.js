import{s as t}from"./authority.c22e40dc.js";import{w as i}from"./warningBar.f4c6efa3.js";import{_ as a}from"./index.bf0eadd2.js";import{r,o as e,f as h,k as o,g as s,w as d,F as n,A as u,s as l,x as y,u as c}from"./vendor.ab24dc3f.js";const f={name:"Datas",components:{warningBar:i},props:{row:{default:function(){return{}},type:Object},authority:{default:function(){return[]},type:Array}},data:()=>({authoritys:[],dataAuthorityId:[],needConfirm:!1}),created(){this.authoritys=[],this.dataAuthorityId=[],this.roundAuthority(this.authority),this.row.dataAuthorityId&&this.row.dataAuthorityId.forEach((t=>{const i=this.authoritys&&this.authoritys.filter((i=>i.authorityId===t.authorityId))&&this.authoritys.filter((i=>i.authorityId===t.authorityId))[0];this.dataAuthorityId.push(i)}))},methods:{enterAndNext(){this.authDataEnter()},all(){this.dataAuthorityId=[...this.authoritys],this.$emit("changeRow","dataAuthorityId",this.dataAuthorityId),this.needConfirm=!0},self(){this.dataAuthorityId=this.authoritys.filter((t=>t.authorityId===this.row.authorityId)),this.$emit("changeRow","dataAuthorityId",this.dataAuthorityId),this.needConfirm=!0},selfAndChildren(){const t=[];this.getChildrenId(this.row,t),this.dataAuthorityId=this.authoritys.filter((i=>t.indexOf(i.authorityId)>-1)),this.$emit("changeRow","dataAuthorityId",this.dataAuthorityId),this.needConfirm=!0},getChildrenId(t,i){i.push(t.authorityId),t.children&&t.children.forEach((t=>{this.getChildrenId(t,i)}))},authDataEnter(){return i=this,a=null,r=function*(){0===(yield t(this.row)).code&&this.$message({type:"success",message:"资源设置成功"})},new Promise(((t,e)=>{var h=t=>{try{s(r.next(t))}catch(i){e(i)}},o=t=>{try{s(r.throw(t))}catch(i){e(i)}},s=i=>i.done?t(i.value):Promise.resolve(i.value).then(h,o);s((r=r.apply(i,a)).next())}));var i,a,r},roundAuthority(t){t&&t.forEach((t=>{const i={};i.authorityId=t.authorityId,i.authorityName=t.authorityName,this.authoritys.push(i),t.children&&t.children.length&&this.roundAuthority(t.children)}))},selectAuthority(){this.$emit("changeRow","dataAuthorityId",this.dataAuthorityId),this.needConfirm=!0}}},m={class:"clearflex",style:{margin:"18px"}},I=l("确 定"),A=l("全选"),p=l("本角色"),C=l("本角色及子角色");var g=a(f,[["render",function(t,i,a,f,g,w){const k=r("el-button"),x=r("el-checkbox"),b=r("el-checkbox-group"),v=r("warning-bar");return e(),h("div",null,[o("div",m,[s(k,{class:"fl-right",size:"mini",type:"primary",onClick:w.authDataEnter},{default:d((()=>[I])),_:1},8,["onClick"]),s(k,{class:"fl-left",size:"mini",type:"primary",onClick:w.all},{default:d((()=>[A])),_:1},8,["onClick"]),s(k,{class:"fl-left",size:"mini",type:"primary",onClick:w.self},{default:d((()=>[p])),_:1},8,["onClick"]),s(k,{class:"fl-left",size:"mini",type:"primary",onClick:w.selfAndChildren},{default:d((()=>[C])),_:1},8,["onClick"])]),s(b,{modelValue:g.dataAuthorityId,"onUpdate:modelValue":i[0]||(i[0]=t=>g.dataAuthorityId=t),onChange:w.selectAuthority},{default:d((()=>[(e(!0),h(n,null,u(g.authoritys,((t,i)=>(e(),y(x,{key:i,label:t},{default:d((()=>[l(c(t.authorityName),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"]),s(v,{title:"此功能仅用于创建角色和角色的many2many关系表，具体使用还须自己结合表实现业务，详情参考示例代码（客户示例）"})])}]]);export{g as default};
